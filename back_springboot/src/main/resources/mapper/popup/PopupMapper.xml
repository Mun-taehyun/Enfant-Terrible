<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.enfantTerrible.enfantTerrible.mapper.popup.PopupMapper">

  <select id="findActivePopups" resultType="com.enfantTerrible.enfantTerrible.dto.popup.PopupRow">
    SELECT
      popup_id,
      title,
      content,
      link_url,
      position,
      width,
      height,
      is_active,
      start_at,
      end_at,
      created_at,
      updated_at,
      deleted_at
    FROM et_popup
    WHERE deleted_at IS NULL
      AND is_active = 1
      AND (start_at IS NULL OR start_at &lt;= NOW())
      AND (end_at IS NULL OR end_at &gt;= NOW())
    ORDER BY popup_id DESC
  </select>

</mapper>
