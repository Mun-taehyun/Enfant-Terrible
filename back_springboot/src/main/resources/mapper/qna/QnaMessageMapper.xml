<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.enfantTerrible.enfantTerrible.mapper.qna.QnaMessageMapper">

  <insert id="insert">
    INSERT INTO et_qna_message (
      room_id,
      sender,
      message
    ) VALUES (
      #{roomId},
      #{sender},
      #{message}
    )
  </insert>

  <select id="findLastInsertId" resultType="long">
    SELECT LAST_INSERT_ID()
  </select>

  <select id="findRecentByRoomId" resultType="com.enfantTerrible.enfantTerrible.dto.qna.QnaMessageRow">
    SELECT
      message_id,
      room_id,
      sender,
      message,
      created_at
    FROM et_qna_message
    WHERE room_id = #{roomId}
    ORDER BY message_id DESC
    LIMIT #{limit}
  </select>

</mapper>
