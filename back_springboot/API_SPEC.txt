EnfantTerrible Spring Boot API 명세서

Base URL
- http://localhost:8080

공통 응답 포맷(ApiResponse<T>)
- success: boolean
- data: T | null
- message: string

인증/인가 개요 (SecurityConfig 기준)
- 인증 없이 접근(permitAll)
  - /api/auth/**
  - /api/users/signup
  - /api/users/password/reset
  - /api/categories/**
  - /api/posts/**
  - /api/banners/**
  - /api/popups/**
  - /ws/**
  - /oauth2/**, /login/oauth2/**
- 관리자 전용
  - /api/admin/** : ROLE_ADMIN 필요
- 그 외 /api/**
  - 인증 필요(JWT)

인증 헤더
- Authorization: Bearer <ACCESS_TOKEN>
  - 실제 prefix는 JwtAuthenticationFilter 구현에 따라 다를 수 있으나, 일반적으로 Bearer 사용

=============================
1) Auth
=============================
POST /api/auth/login
- Auth: 없음
- Body (LoginRequest)
  - email: string (필수)
  - password: string (필수)
- Response (LoginResponse)
  - accessToken: string
  - refreshToken: string

POST /api/auth/email/signup
- Auth: 없음
- Body (EmailRequest)
  - email: string (필수)
- Response: ApiResponse<Void>

POST /api/auth/email/verify
- Auth: 없음
- Body (EmailVerificationRequest)
  - email: string (필수)
  - code: string (필수)
- Response: ApiResponse<Void>

POST /api/auth/password/reset/request
- Auth: 없음
- Body (EmailRequest)
  - email: string (필수)
- Response: ApiResponse<Void>

POST /api/auth/password/reset/verify
- Auth: 없음
- Body (EmailVerificationRequest)
  - email: string (필수)
  - code: string (필수)
- Response: ApiResponse<Void>

PUT /api/auth/password/reset
- Auth: 없음
- Body (ResetPasswordRequest)
  - email: string (선택/구현상 nullable)
  - newPassword: string (필수)
- Response: ApiResponse<Void>

=============================
2) Users
=============================
POST /api/users/signup
- Auth: 없음
- Body (SignupRequest)
  - email: string (필수)
  - password: string (필수, 8~20)
  - name: string (필수)
  - tel: string (필수)
  - zipCode: string (필수)
  - addressBase: string (필수)
  - addressDetail: string (선택)
- Response: ApiResponse<UserResponse>

GET /api/users/me
- Auth: 필요
- Response: ApiResponse<UserResponse>

PUT /api/users/me
- Auth: 필요
- Body (UpdateProfileRequest)
  - name: string (필수)
  - tel: string (필수)
  - zipCode: string (필수)
  - addressBase: string (필수)
  - addressDetail: string (선택)
- Response: ApiResponse<UserResponse>

PUT /api/users/me/password
- Auth: 필요
- Body (ChangePasswordRequest)
  - currentPassword: string (선택/구현상 nullable)
  - newPassword: string (필수, 8~20)
- Response: ApiResponse<Void>

DELETE /api/users/me
- Auth: 필요
- Response: ApiResponse<Void>

POST /api/users/me/profile/complete
- Auth: 필요
- Body (CompleteProfileRequest)
  - tel: string (필수)
  - zipCode: string (필수)
  - addressBase: string (필수)
  - addressDetail: string (선택)
- Response: ApiResponse<Void>

=============================
3) Pets (내 펫)
=============================
POST /api/users/me/pets
- Auth: 필요
- Body (PetSaveRequest)
  - name: string (선택)
  - species: enum (선택)
  - breed: string (선택)
  - age: number (선택)
  - gender: enum (선택)
  - isNeutered: boolean (선택)
  - activityLevel: number (선택)
  - weight: number (선택)
- Response: ApiResponse<Long> (petId)

GET /api/users/me/pets
- Auth: 필요
- Response: ApiResponse<List<PetResponse>>

PUT /api/users/me/pets/{petId}
- Auth: 필요
- Body: PetSaveRequest
- Response: ApiResponse<Void>

DELETE /api/users/me/pets/{petId}
- Auth: 필요
- Response: ApiResponse<Void>

=============================
4) Catalog (공개)
=============================
GET /api/categories/tree
- Auth: 없음
- Response: ApiResponse<List<CategoryResponse>>

GET /api/categories/children?parentId={parentId}
- Auth: 없음
- Query
  - parentId: number (필수)
- Response: ApiResponse<List<CategoryResponse>>

GET /api/products
- Auth: 필요(※SecurityConfig 상 /api/** 기본 인증 필요. 다만 permitAll 목록에 /api/products/**가 없으므로 토큰 필요)
- Query
  - page: number (선택)
  - size: number (선택)
  - categoryId: number (선택)
  - keyword: string (선택)
  - sort: string (선택)
- Response: ApiResponse<List<ProductResponse>>

GET /api/products/{productId}
- Auth: 필요(코드상 principal null 허용이지만, SecurityConfig 상 /api/** 인증 필요라서 실제로는 토큰이 필요할 수 있음)
- Path
  - productId: number
- Response: ApiResponse<ProductDetailResponse>

GET /api/products/{productId}/skus/resolve?optionValueIds=1,2,3
- Auth: 필요
- Query
  - optionValueIds: string (CSV, 필수)
- Response: ApiResponse<ProductSkuResolveResponse>

GET /api/posts
- Auth: 없음
- Query
  - page: number (선택)
  - size: number (선택)
  - postType: string (선택)
- Response: ApiResponse<List<PostResponse>>

GET /api/posts/{postId}
- Auth: 없음
- Response: ApiResponse<PostResponse>

GET /api/banners
- Auth: 없음
- Response: ApiResponse<List<BannerResponse>>

GET /api/popups
- Auth: 없음
- Response: ApiResponse<List<PopupResponse>>

=============================
5) Cart
=============================
POST /api/cart/items
- Auth: 필요
- Body (CartItemAddRequest)
  - skuId: number (필수)
  - quantity: number (필수, >=1)
- Response: ApiResponse<Void>

GET /api/cart/items
- Auth: 필요
- Response: ApiResponse<List<CartItemResponse>>

PUT /api/cart/items/{cartItemId}
- Auth: 필요
- Body (CartItemUpdateRequest)
  - quantity: number (필수, >=1)
- Response: ApiResponse<Void>

DELETE /api/cart/items/{cartItemId}
- Auth: 필요
- Response: ApiResponse<Void>

DELETE /api/cart/items
- Auth: 필요
- Response: ApiResponse<Void>

=============================
6) Orders
=============================
POST /api/orders/from-cart
- Auth: 필요
- Body (OrderFromCartRequest)
  - receiverName: string (필수)
  - receiverPhone: string (필수)
  - zipCode: string (필수)
  - addressBase: string (필수)
  - addressDetail: string (선택)
- Response: ApiResponse<OrderCreateResponse>

POST /api/orders/direct
- Auth: 필요
- Body (DirectOrderRequest)
  - productId: number (필수)
  - optionValueIds: number[] (선택, 단 controller에서 비어있으면 예외)
  - quantity: number (필수)
  - receiverName: string (필수)
  - receiverPhone: string (필수)
  - zipCode: string (필수)
  - addressBase: string (필수)
  - addressDetail: string (선택)
- Response: ApiResponse<OrderCreateResponse>

=============================
7) Payments
=============================
POST /api/payments/confirm
- Auth: 필요
- Body (PaymentConfirmRequest)
  - paymentId: string (필수)  // PortOne 결제 ID
  - orderId: string (필수)    // 우리 시스템 orderCode 사용 권장
  - amount: number (필수)
- Response: ApiResponse<PaymentConfirmResponse>

POST /api/payments/cancel
- Auth: 필요
- Body (PaymentCancelRequest)
  - paymentId: string (필수)
  - orderId: string (필수)    // orderCode
  - amount: number (필수)
  - reason: string (선택)
- Response: ApiResponse<PaymentCancelResponse>

=============================
8) Points
=============================
GET /api/points/me
- Auth: 필요
- Response: ApiResponse<PointBalanceResponse>

GET /api/points/me/history
- Auth: 필요
- Query
  - page: number (선택)
  - size: number (선택)
- Response: ApiResponse<List<PointHistoryResponse>>

POST /api/points/me/earn
- Auth: 필요
- Body (PointChangeRequest)
  - amount: number (필수, >=1)
  - reason: string (선택)
  - refType: string (선택)
  - refId: number (선택)
- Response: ApiResponse<Void>

POST /api/points/me/use
- Auth: 필요
- Body: PointChangeRequest
- Response: ApiResponse<Void>

=============================
9) Reviews
=============================
GET /api/products/{productId}/reviews
- Auth: 없음
- Query
  - page: number (선택)
  - size: number (선택)
- Response: ApiResponse<List<ProductReviewResponse>>

POST /api/products/{productId}/reviews
- Auth: 필요
- Body (ProductReviewCreateRequest)
  - orderId: number (필수)
  - rating: number (필수, 1~5)
  - content: string (선택)
- Response: ApiResponse<ProductReviewResponse>

PUT /api/reviews/{reviewId}
- Auth: 필요
- Body (ProductReviewUpdateRequest)
  - rating: number (필수, 1~5)
  - content: string (선택)
- Response: ApiResponse<ProductReviewResponse>

DELETE /api/reviews/{reviewId}
- Auth: 필요
- Response: ApiResponse<Void>

=============================
10) QnA
=============================
GET /api/qna/room
- Auth: 필요
- Response: ApiResponse<QnaRoomResponse>

GET /api/qna/messages?roomId={roomId}&limit={limit}
- Auth: 필요
- Query
  - roomId: number (필수)
  - limit: number (선택, 기본 30)
- Response: ApiResponse<List<QnaMessageResponse>>

=============================
11) Admin (ROLE_ADMIN)
=============================
[Users]
GET /api/admin/users
- Auth: ADMIN
- Query (AdminUserSearchRequest)
  - page: number (기본 1)
  - size: number (기본 20)
  - email: string (선택)
  - name: string (선택)
  - status: string (선택)
  - provider: string (선택)
  - createdFrom: datetime (선택)
  - createdTo: datetime (선택)
- Response: ApiResponse<AdminPageResponse<AdminUserListResponse>>

GET /api/admin/users/{userId}
- Auth: ADMIN
- Response: ApiResponse<AdminUserDetailResponse>

PATCH /api/admin/users/{userId}/status
- Auth: ADMIN
- Body (AdminUserStatusUpdateRequest)
  - status: string (필수)
- Response: ApiResponse<Void>

[Categories]
GET /api/admin/categories
POST /api/admin/categories
PATCH /api/admin/categories/{categoryId}
PATCH /api/admin/categories/{categoryId}/active?isActive=Y|N
PATCH /api/admin/categories/{categoryId}/sort-order?sortOrder={n}
PATCH /api/admin/categories/{categoryId}/move?parentId={parentId}
DELETE /api/admin/categories/{categoryId}
- Auth: ADMIN
- Body
  - create: AdminCategoryCreateRequest(parentId?, name, sortOrder)
  - update: AdminCategoryUpdateRequest(categoryId, name, sortOrder, isActive)

[Products]
GET /api/admin/products
GET /api/admin/products/{productId}
POST /api/admin/products
PUT /api/admin/products/{productId}
DELETE /api/admin/products/{productId}
- Auth: ADMIN
- Query (list): AdminProductListRequest(page?, size?, keyword?, productCode?, status?)
- Body (save): AdminProductSaveRequest(productCode, categoryId, name, basePrice, status, thumbnailFileId?)

[Product Options]
GET /api/admin/products/options/groups?productId={productId}
POST /api/admin/products/options/groups
PUT /api/admin/products/options/groups/{groupId}
DELETE /api/admin/products/options/groups/{groupId}
GET /api/admin/products/options/values?groupId={groupId}
POST /api/admin/products/options/values
PUT /api/admin/products/options/values/{valueId}
DELETE /api/admin/products/options/values/{valueId}
- Auth: ADMIN
- Body
  - group save: AdminProductOptionGroupSaveRequest(productId, name, sortOrder?)
  - value save: AdminProductOptionValueSaveRequest(optionGroupId, value, sortOrder?)

[SKUs]
GET /api/admin/products/skus
GET /api/admin/products/skus/{skuId}
PUT /api/admin/products/skus/{skuId}
- Auth: ADMIN
- Query (list): AdminSkuListRequest(page?, size?, productId?, status?)
- Body (update): AdminSkuSaveRequest(productId, price, stock, status, optionValueIds?)

[Discounts]
GET /api/admin/product-discounts?productId={productId}
POST /api/admin/product-discounts
PUT /api/admin/product-discounts/{discountId}
DELETE /api/admin/product-discounts/{discountId}
- Auth: ADMIN
- Body: AdminProductDiscountSaveRequest(productId, discountValue, discountType, startAt?, endAt?)

[Orders]
GET /api/admin/orders
GET /api/admin/orders/{orderId}
PATCH /api/admin/orders/{orderId}/status
PATCH /api/admin/orders/{orderId}/shipping
POST /api/admin/orders/{orderId}/items/cancel
- Auth: ADMIN
- Query (list): AdminOrderListRequest(page=1,size=20,userId?,orderCode?,status?)
- Body
  - status: AdminOrderStatusUpdateRequest(status)
  - shipping: AdminOrderShippingRequest(trackingNumber)
  - cancel items: AdminOrderItemCancelRequest(items[{skuId,quantity}], reason?)

[Payments]
GET /api/admin/payments
GET /api/admin/payments/{paymentId}
POST /api/admin/payments/{paymentId}/cancel
- Auth: ADMIN
- Query (list): AdminPaymentListRequest(page=1,size=20,userId?,orderId?,orderCode?,paymentStatus?)
- Body (cancel): AdminPaymentCancelRequest(amount, reason?)

[Points]
GET /api/admin/points/users/{userId}/balance
GET /api/admin/points/users/{userId}/history
POST /api/admin/points/users/{userId}/adjust
- Auth: ADMIN
- Query (history): AdminPointHistoryRequest(page=1,size=20)
- Body (adjust): AdminPointAdjustRequest(amount, reason?, refType?, refId?)

[Posts]
GET /api/admin/posts
GET /api/admin/posts/{postId}
POST /api/admin/posts
PUT /api/admin/posts/{postId}
DELETE /api/admin/posts/{postId}
- Auth: ADMIN
- Query (list): AdminPostListRequest(page=1,size=20,postType?,userId?)
- Body (save): AdminPostSaveRequest(postType, refType?, refId?, title, content)

[Banners]
GET /api/admin/banners
GET /api/admin/banners/{bannerId}
POST /api/admin/banners
PUT /api/admin/banners/{bannerId}
DELETE /api/admin/banners/{bannerId}
- Auth: ADMIN
- Query (list): AdminBannerListRequest(page=1,size=20,title?,isActive?)
- Body (save): AdminBannerSaveRequest(title, linkUrl?, sortOrder?, isActive?, startAt?, endAt?, imageUrl?)

[Popups]
GET /api/admin/popups
GET /api/admin/popups/{popupId}
POST /api/admin/popups
PUT /api/admin/popups/{popupId}
DELETE /api/admin/popups/{popupId}
- Auth: ADMIN
- Query (list): AdminPopupListRequest(page=1,size=20,title?,isActive?)
- Body (save): AdminPopupSaveRequest(title, content?, linkUrl?, position?, width?, height?, isActive?, startAt?, endAt?, imageUrl?)

[QnA]
GET /api/admin/qna/rooms
GET /api/admin/qna/messages?roomId={roomId}&limit={limit}
- Auth: ADMIN
- Query (rooms): AdminQnaRoomListRequest(page=1,size=20,userId?)
- Query (messages): roomId 필수, limit 기본 50
